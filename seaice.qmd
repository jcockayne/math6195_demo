---
title: "Sea Ice"
format: html
---

## Analysis of the Sea Ice Extents Dataset

We have been supplied with the file `icesheet.R` which contains some analysis
of sea ice extents that we will reproduce below.

We first load the file from the `amstat` website.
We'll assign it some more informative names and preview the data.

```{r}
#| message: false
library(tidyverse)
seaIce <- read_tsv("http://jse.amstat.org/v21n1/witt/sea_ice_data.txt")
names(seaIce) <- c("Year", "SeaIceExtent") # rename columns for convenience
head(seaIce) # preview the data
```

Now we will fit a linear model regressing sea ice extents against year:

```{r}
## fit a simple linear model, regress sea ice extent on year
seaIce1.lm <- lm(SeaIceExtent ~ Year, data = seaIce)
```

Now we will plot the output of the model:

```{r}
## make predictions that we can plot
seaIce <- seaIce |>
    mutate(Predicted = predict(seaIce1.lm, newdata = seaIce))

ggplot(seaIce, aes(x = Year, y = SeaIceExtent)) +
    geom_point(size = 3) +
    geom_line(aes(x=Year, y=Predicted), color="blue") +
    scale_y_continuous(limits = c(0, 9)) +
    labs(y = "Arctic sea ice extent (million sq km)") +
    theme_minimal(base_size = 18)
```

We can see that it appears the model is a reasonably good fit.

```{r}
print(coef(seaIce1.lm))
```

On average, the extent of sea ice is decreasing by `r sprintf("%.0f", -coef(seaIce1.lm)[2]*1000000)` sq km per year (about the size of Portugal)

## Quadratic Modelling

Now we will implement a simple quadratic model

```{r}
## fit a tenth order model to regress sea ice extent on year
seaIce2.lm <- lm(SeaIceExtent ~ poly(Year, 10), data = seaIce)
```

Now we will plot the output of the model:

```{r}
## make predictions that we can plot
seaIce <- seaIce |>
    mutate(Predicted = predict(seaIce2.lm, newdata = seaIce))

ggplot(seaIce, aes(x = Year, y = SeaIceExtent)) +
    geom_point(size = 3) +
    geom_line(aes(x=Year, y=Predicted), color="blue") +
    scale_y_continuous(limits = c(0, 9)) +
    labs(y = "Arctic sea ice extent (million sq km)") +
    theme_minimal(base_size = 18)
```

